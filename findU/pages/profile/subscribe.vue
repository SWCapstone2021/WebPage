<template>
  <base-section class>
    <v-row justify="center">
      <v-col cols="12" md="8">
        <v-container>
          <p class="text-h5 font-weight-bold text-center">FindU Subscription</p>
          <v-divider class="my-5"></v-divider>
          <v-container>
            <v-row>
              <v-col cols="12" md="6">
                <v-card class="mx-auto">
                  <v-img
                    :src="require('@/assets/free.jpg')"
                    height="200px"
                  ></v-img>
                  <v-card-title>Free</v-card-title>
                  <v-card-subtitle> 0$ per month </v-card-subtitle>
                  <v-card-text>
                    <div
                      v-for="(item, idx) in memberFree"
                      :key="idx"
                      class="d-flex align-center"
                    >
                      <v-icon :color="item.can ? 'success' : 'error'">
                        mdi-{{ item.can ? 'check' : 'close' }}
                      </v-icon>
                      <span>{{ item.description }}</span>
                    </div>
                  </v-card-text>
                  <v-spacer></v-spacer>
                </v-card>
              </v-col>
              <v-col cols="12" md="6">
                <v-card class="mx-auto">
                  <v-img
                    :src="require('@/assets/preminum.jpg')"
                    height="200px"
                  ></v-img>
                  <v-card-title>Pro</v-card-title>
                  <v-card-subtitle> 1$ per month </v-card-subtitle>
                  <v-card-text>
                    <div
                      v-for="(item, idx) in memberPro"
                      :key="idx"
                      class="d-flex align-center"
                    >
                      <v-icon :color="item.can ? 'success' : 'error'">
                        mdi-{{ item.can ? 'check' : 'close' }}
                      </v-icon>
                      <span>{{ item.description }}</span>
                    </div>
                  </v-card-text>
                  <v-spacer></v-spacer>
                  <v-card-actions>
                    <v-btn
                      :disabled="userMembership"
                      text
                      color="teal accent-4"
                      @click="upgradeToPro"
                    >
                      {{ proBTN }}
                    </v-btn>
                  </v-card-actions>
                </v-card>
              </v-col>
            </v-row>
          </v-container>
        </v-container>
      </v-col>
    </v-row>
  </base-section>
</template>

<script>
import BaseSection from '@/components/base/Section'
export default {
  name: 'Subscribe',
  components: { BaseSection },
  layout: 'DashboardLayout',
  data() {
    return {
      userMembership: true,
      memberFree: [
        { description: 'enhance search result by reliability', can: true },
        { description: 'find video by using keyword', can: true },
        { description: 'read summary of video', can: false },
      ],
      memberPro: [
        { description: 'enhance search result by reliability', can: true },
        { description: 'find video by using keyword', can: true },
        { description: 'find video with advanced option', can: true },
        { description: 'read summary of video', can: true },
      ],
    }
  },
  computed: {
    user() {
      return this.$store.state.user
    },
    userName() {
      return this.user ? this.user.displayName : 'APC'
    },
    userEmail() {
      return this.user ? this.user.email : 'example@abcd.email'
    },
    proBTN() {
      return this.userMembership ? 'Currently Using it' : 'Upgrade to PRO'
    },
  },
  mounted() {
    if (!this.$store.state.user) {
      this.$router.push({ path: '/auth/login' })
    }
  },
  methods: {
    upgradeToPro() {
      const prevThis = this
      this.$dialog
        .confirm({
          text: 'This is FindU Agreement Statement',
          title: 'Please confirm to continue',
        })
        .then(function (dialog) {
          if (dialog) {
            console.log('Clicked on proceed!')
            prevThis.$router.push('/profile/purchase')
          } else {
            console.log('Clicked on cancel!')
          }
        })
        .catch(function () {
          console.log('Clicked on cancel')
        })
    },
    updateToFree() {
      const userRef = this.$fire.firestore.collection('user')

      userRef.doc(this.userEmail).set({
        membership: 'Free',
      })
    },
  },
}
</script>
